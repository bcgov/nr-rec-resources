/* !!! This is code generated by Prisma. Do not edit directly. !!!
/* eslint-disable */
'use strict';
const {
  makeTypedQueryFactory: $mkFactory,
} = require('@prisma/client/runtime/library');
exports.getRecreationResourceGeospatialData = /*#__PURE__*/ $mkFactory(
  '\nWITH feature_data AS (\nSELECT\nrmf.rec_resource_id,\narray_agg(public.st_asgeojson(rmfg.geometry)) as spatial_feature_geometry,\npublic.ST_Centroid(public.ST_Collect(rmfg.geometry)) as feature_centroid\nFROM rst.recreation_map_feature rmf\nINNER JOIN rst.recreation_map_feature_geom rmfg USING (rmf_skey)\nWHERE rmf.rec_resource_id = $1\nAND rmf.retirement_date IS NULL\nGROUP BY rmf.rec_resource_id\n),\nsite_data AS (\nSELECT\nrec_resource_id,\ngeometry as site_geometry\nFROM rst.recreation_site_point\nWHERE rec_resource_id = $1\n),\nnormalized_geometry AS (\nSELECT\nfd.spatial_feature_geometry,\nCOALESCE(sd.site_geometry, fd.feature_centroid) as source_geometry,\nCASE\nWHEN COALESCE(sd.site_geometry, fd.feature_centroid) IS NULL THEN NULL\nWHEN public.ST_SRID(COALESCE(sd.site_geometry, fd.feature_centroid)) = 0\nTHEN public.ST_SetSRID(COALESCE(sd.site_geometry, fd.feature_centroid), 3005)\nELSE COALESCE(sd.site_geometry, fd.feature_centroid)\nEND as geometry_with_srid\nFROM feature_data fd\nLEFT JOIN site_data sd ON fd.rec_resource_id = sd.rec_resource_id\n),\nwgs84_coords AS (\nSELECT\nspatial_feature_geometry,\nsource_geometry,\ngeometry_with_srid,\npublic.ST_Transform(geometry_with_srid, 4326) as wgs84_geometry,\npublic.ST_X(public.ST_Transform(geometry_with_srid, 4326)) as longitude_raw,\npublic.ST_Y(public.ST_Transform(geometry_with_srid, 4326)) as latitude_raw\nFROM normalized_geometry\nWHERE geometry_with_srid IS NOT NULL\n),\nutm_params AS (\nSELECT\nspatial_feature_geometry,\nsource_geometry,\ngeometry_with_srid,\nwgs84_geometry,\nlongitude_raw,\nlatitude_raw,\nFLOOR((longitude_raw + 180) / 6)::integer + 1 as utm_zone,\n32600 + FLOOR((longitude_raw + 180) / 6)::integer + 1 as utm_srid\nFROM wgs84_coords\n)\nSELECT\nspatial_feature_geometry,\npublic.st_asgeojson(source_geometry) as site_point_geometry,\nROUND(latitude_raw::numeric, 4) as latitude,\nROUND(longitude_raw::numeric, 4) as longitude,\nutm_zone,\nROUND(public.ST_X(public.ST_Transform(geometry_with_srid, utm_srid)))::integer as utm_easting,\nROUND(public.ST_Y(public.ST_Transform(geometry_with_srid, utm_srid)))::integer as utm_northing\nFROM utm_params;',
);
