/* !!! This is code generated by Prisma. Do not edit directly. !!! */
/* eslint-disable */
// biome-ignore-all lint: generated file
// @ts-nocheck
import * as $runtime from '@prisma/client/runtime/client';

/**
 * @param text
 */
export const getRecreationResourceGeospatialData =
  $runtime.makeTypedQueryFactory(
    '\nWITH\nfeature_geom_normalized AS (\nSELECT\nrmf.rec_resource_id,\nrmfg.geometry,\nCASE\nWHEN public.ST_SRID(rmfg.geometry) = 0\nTHEN public.ST_SetSRID(rmfg.geometry, 3005)\nELSE rmfg.geometry\nEND AS geom_3005\nFROM rst.recreation_map_feature rmf\nINNER JOIN rst.recreation_map_feature_geom rmfg USING (rmf_skey)\nWHERE rmf.rec_resource_id = $1\nAND rmf.retirement_date IS NULL\n),\nfeature_geom_typed AS (\nSELECT\nrec_resource_id,\ngeometry,\ngeom_3005,\npublic.ST_GeometryType(geom_3005) AS geom_type\nFROM feature_geom_normalized\n),\nfeature_data AS (\nSELECT\nrec_resource_id,\narray_agg(public.st_asgeojson(geometry)) AS spatial_feature_geometry,\nROUND(SUM(\nCASE\nWHEN geom_type IN (\'ST_Polygon\', \'ST_MultiPolygon\')\nTHEN public.ST_Area(geom_3005)\nELSE 0\nEND\n)::numeric / 10000, 4) AS total_area_hectares,\nROUND(SUM(\nCASE\nWHEN geom_type IN (\'ST_Polygon\', \'ST_MultiPolygon\')\nTHEN public.ST_Perimeter(geom_3005)\nELSE 0\nEND\n)::numeric / 1000, 4) AS perimeter_km,\nROUND(SUM(\nCASE\nWHEN geom_type IN (\'ST_LineString\', \'ST_MultiLineString\')\nTHEN public.ST_Length(geom_3005)\nELSE 0\nEND\n)::numeric / 1000, 4) AS length_km\nFROM feature_geom_typed\nGROUP BY rec_resource_id\n),\nsite_data AS (\nSELECT\nrec_resource_id,\ngeometry as site_geometry\nFROM rst.recreation_site_point\nWHERE rec_resource_id = $1\n),\nsite_geometry_normalized AS (\nSELECT\nsd.rec_resource_id,\nsd.site_geometry,\nCASE\nWHEN sd.site_geometry IS NULL THEN NULL\nWHEN public.ST_SRID(sd.site_geometry) = 0\nTHEN public.ST_SetSRID(sd.site_geometry, 3005)\nELSE sd.site_geometry\nEND as geometry_with_srid\nFROM site_data sd\n),\nsite_coordinates_wgs84 AS (\nSELECT\nrec_resource_id,\nsite_geometry,\ngeometry_with_srid,\npublic.ST_Transform(geometry_with_srid, 4326) AS wgs84\nFROM site_geometry_normalized\nWHERE geometry_with_srid IS NOT NULL\n),\nsite_coordinates_xy AS (\nSELECT\nrec_resource_id,\nsite_geometry,\ngeometry_with_srid,\npublic.ST_X(wgs84) AS longitude_raw,\npublic.ST_Y(wgs84) AS latitude_raw\nFROM site_coordinates_wgs84\n),\nsite_coordinates AS (\nSELECT\nrec_resource_id,\nsite_geometry,\ngeometry_with_srid,\nlongitude_raw,\nlatitude_raw,\n(FLOOR((longitude_raw + 180) / 6)::integer + 1) AS utm_zone,\n(32600 + FLOOR((longitude_raw + 180) / 6)::integer + 1) AS utm_srid\nFROM site_coordinates_xy\n),\nsite_utm_geom AS (\nSELECT\nsc.rec_resource_id,\nsc.site_geometry,\nsc.geometry_with_srid,\nsc.longitude_raw,\nsc.latitude_raw,\nsc.utm_zone,\nsc.utm_srid,\npublic.ST_Transform(sc.geometry_with_srid, sc.utm_srid) AS utm_geom\nFROM site_coordinates sc\n),\nsite_coordinates_with_utm AS (\nSELECT\nrec_resource_id,\nsite_geometry,\ngeometry_with_srid,\nlongitude_raw,\nlatitude_raw,\nutm_zone,\nutm_srid,\nROUND(public.ST_X(utm_geom))::integer AS utm_easting,\nROUND(public.ST_Y(utm_geom))::integer AS utm_northing\nFROM site_utm_geom\n)\nSELECT\nCOALESCE(fd.spatial_feature_geometry, ARRAY[]::text[]) AS spatial_feature_geometry,\nCOALESCE(fd.perimeter_km, 0) + COALESCE(fd.length_km, 0) AS total_length_km,\nROUND(\nCOALESCE(fd.total_area_hectares, 0)\n+ CASE\nWHEN fd.length_km IS NOT NULL AND rr.right_of_way IS NOT NULL\nTHEN (fd.length_km * rr.right_of_way)::numeric / 10\nELSE 0\nEND,\n4\n) AS total_area_hectares,\nrr.right_of_way AS right_of_way_m,\npublic.st_asgeojson(sc.site_geometry) AS site_point_geometry,\nROUND(sc.latitude_raw::numeric, 4) AS latitude,\nROUND(sc.longitude_raw::numeric, 4) AS longitude,\nsc.utm_zone,\nsc.utm_easting,\nsc.utm_northing\nFROM feature_data fd\nFULL OUTER JOIN site_coordinates_with_utm sc ON fd.rec_resource_id = sc.rec_resource_id\nLEFT JOIN rst.recreation_resource rr ON rr.rec_resource_id = $1;  -- right_of_way (m) for trail area',
  ) as (
    text: string,
  ) => $runtime.TypedSql<
    getRecreationResourceGeospatialData.Parameters,
    getRecreationResourceGeospatialData.Result
  >;

export namespace getRecreationResourceGeospatialData {
  export type Parameters = [text: string];
  export type Result = {
    spatial_feature_geometry: string[] | null;
    total_length_km: $runtime.Decimal | null;
    total_area_hectares: $runtime.Decimal | null;
    right_of_way_m: $runtime.Decimal | null;
    site_point_geometry: string | null;
    latitude: $runtime.Decimal | null;
    longitude: $runtime.Decimal | null;
    utm_zone: number | null;
    utm_easting: number | null;
    utm_northing: number | null;
  };
}
